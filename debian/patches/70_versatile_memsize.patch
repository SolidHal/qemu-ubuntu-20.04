--- a/hw/versatilepb.c
+++ b/hw/versatilepb.c
@@ -176,6 +176,12 @@
         fprintf(stderr, "Unable to find CPU definition\n");
         exit(1);
     }
+    if (ram_size > (256 << 20)) {
+        fprintf(stderr,
+                "qemu: Too much memory for this machine: %d MB, maximum 256 MB\n",
+                ((unsigned int)ram_size / (1 << 20)));
+        exit(1);
+    }
     /* ??? RAM should repeat to fill physical memory space.  */
     /* SDRAM at address zero.  */
     cpu_register_physical_memory(0, ram_size, IO_MEM_RAM);
