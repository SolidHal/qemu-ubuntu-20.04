diff --git a/slirp/bootp.c b/slirp/bootp.c
index 3ae3db2..6166ccc 100644
--- a/slirp/bootp.c
+++ b/slirp/bootp.c
@@ -156,10 +156,15 @@ static void bootp_reply(struct bootp_t *bp)
 
     if (dhcp_msg_type == DHCPDISCOVER) {
     new_addr:
-        bc = get_new_addr(&daddr.sin_addr);
+        /* Try to find a previously assigned address */
+        bc = find_addr(&daddr.sin_addr, bp->bp_hwaddr);
         if (!bc) {
-            dprintf("no address left\n");
-            return;
+            /* Try to find the next available address */
+            bc = get_new_addr(&daddr.sin_addr);
+            if (!bc) {
+                dprintf("no address left\n");
+                return;
+            }
         }
         memcpy(bc->macaddr, client_ethaddr, 6);
     } else {
